<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<!--
  Documentation for Jaypha Inet.
  Copyright 2015 Jaypha.
  Distributed under the Boost Licence.
  Written by Jason den Dulk.
-->
<head>
<style type='text/css'>
 *
 {
  padding: 0;
  margin: 0;
 }

  body
  {
   font-size: 12px;
   font-family:arial,sans-serif;
  }
 p, table, dd
 {
   margin-bottom: 0.7em;
 }
 h1,h2,h3 { margin-bottom: 0.7em; }
 h1 { font-size: 22px; color: red; }
 h2 { font-size: 18px; color: red; }
 h3 { font-size: 15px; color: red; }
 
 table
 {
  border-collapse: collapse;
 }
 td, th
 {
  padding: 3px;
  border: 1px solid black;
 }
 .d_decl { background-color: #E4E9EF;
    border-bottom: 2px solid #336600;

    padding: 2px 0 2px 2px;
    text-align: left;
    margin-bottom: 0.7em;
    font-family: monospace;
  }
  .funcName { font-weight: bold; }

  .code { font-family: monospace; }

</style>
<title>Jaypha Inet Email/Mime Utilities Documentation</title>
</head>
<body style=''>
<div style='width:1000px; margin:auto'>

<h1>Jaypha Inet Email/Mime Utilities Documentation</h1>

<h2>Introduction</h2>

<p>This project contains structures and classes for reading and writing IMF/MIME documents.
Also included is a structure for constructing and sending emails.</p>

<p>IMF (Internet Message Format) is the original format for sending emails on the Internet.
MIME (Multimedia Internet Mail Extensions) is an extention to IMF for allowing mulitple
media forms to be send via email. MIME is also used in other Internet protocols such as HTTP.
</p>

<h2>Requirements</h2>

<p>This project requires the jaypha-base package, available through Dub and GitHub.</p>
<p>Also required is the Curl library installed on your system.</p>

<h2>Module Index</h2>
<table>
 <tr><td>jaypha.inet.email</td><td>Structure for building emails.</td></tr>
 <tr><td>jaypha.inet.imf.writing</td><td>Code for writing IMF documents</td></tr>
 <tr><td>jaypha.inet.mime.contentDisposition</td><td>Content-Disposition MIME header</td></tr>
 <tr><td>jaypha.inet.mime.contentType</td><td>Content-Type MIME header</td></tr>
 <tr><td>jaypha.inet.mime.header</td><td>MIME headers</td></tr>
 <tr><td>jaypha.inet.mime.reading</td><td>Code to read MIME documents</td></tr>
 <tr><td>jaypha.inet.mime.writing</td><td>Code to write MIME documents</td></tr>
 <tr><td>jaypha.inet.mime.types</td><td>MIME types and file extensions</td></tr>
</table>

<h2>Structure Index</h2>
<table>
 <thead>
  <tr><th>Name</th><th>Module</th><th>Descritpion</th></tr>
 </thead>
 <tbody>
  <tr><td><a href='#Email'>struct Email</a></td><td>jaypha.inet.email</td><td>Use to construct and send emails</td></tr>
  <tr><td><a href='#Email-Attachment'>struct Email.Attachment</a></td><td>jaypha.inet.email</td><td>Attachments for emails</td></tr>
  <tr><td>struct Mailbox</td><td>jaypha.inet.imf.writing</td><td>Email address used in IMF headers</td></tr>
  <tr><td>struct MimeContentDisposition</td><td>jaypha.inet.mime.content_disposition</td><td>Content-Disposition header</td></tr>
  <tr><td>struct MimeContentType</td><td>jaypha.inet.mime.content_type</td><td>Content-Type header</td></tr>
  <tr><td>struct MimeHeader</td><td>jaypha.inet.mime.header</td><td>Generic MIME header</td></tr>
  <tr><td>struct MimeEntityReader</td><td>jaypha.inet.mime.reading</td><td>Reads a MIME entity from input</td></tr>
  <tr><td>struct MimeEntity</td><td>jaypha.inet.mime.writing</td><td>Represents a MIME entity. Used for writing</td></tr>
 </tbody>
</table>

<h2>Property Index</h2>
<table>
 <thead>
  <tr><th>Name</th><th>Module</th><th>Descritpion</th></tr>
 </thead>
 <tbody>
  <tr><td>mimeVersion</td><td>jaypha.inet.mime.header</td><td>Provides a MIME-Version header</td></tr>
  <tr><td>fileExtMimeTypes</td><td>jaypha.inet.mime.types</td><td>Associative array mapping file extensions to MIME types</td></tr>
 </tbody>
</table>

<h2>Function Index</h2>
<table>
 <thead>
  <tr><th>Name</th><th>Module</th><th>Descritpion</th></tr>
 </thead>
 <tbody>
  <tr><td>imfFold</td><td>jaypha.inet.writing</td><td>Wraps a line to keep line length to a certian maximum length</td></tr>
  <tr><td>unstructuredHeader</td><td>jaypha.inet.writing</td><td>Creates an IMF header for generic header types</td></tr>
  <tr><td>addressHeader</td><td>jaypha.inet.writing</td><td>Creates an IMF header for address header types (from, to, cc etc)</td></tr>
  <tr><td>toString</td><td>jaypha.inet.mime.header</td><td>Outputs MIME/IMF header to a string</td></tr>
  <tr><td>extractMimeParams</td><td>jaypha.inet.mime.reading</td><td>Extracts paramters from a MIME header value string</td></tr>
  <tr><td>parseMimeHeaders</td><td>jaypha.inet.mime.reading</td><td>Extracts and parses headers from an input range</td></tr>
  <tr><td>mimeEntityReader</td><td>jaypha.inet.mime.reading</td><td>Creates a MimeEntityReader struct</td></tr>
  <tr><td>mimeMultipartReader</td><td>jaypha.inet.mime.reading</td><td>Creates an input range of MimeEntityReaders. Used for reading multipart entities</td></tr>
  <tr><td>extMimeType</td><td>jaypha.inet.mime.types</td><td>Returns the MIME type associated with an extension</td></tr>
  <tr><td>fileMimeType</td><td>jaypha.inet.mime.types</td><td>Returns the MIME type associated with a file name</td></tr>
 </tbody>
</table>

<h2>Reference</h2>

<dl>
<h3>jaypha.inet.email</h3>

<dt class="d_decl">struct <a name="Email"></a><span class="funcName">Email</span></dt>
<dd><p> A structure for constructing and sending emails.</p>
<p>To use Email, supply the properties with the appropriate values. Then call <i>sendmail</i> (Linux only)
to send the email using the system sendmail program, or <i>send</i> to use Curl. You can 
obtain a formatted copy using <i>copy</i>.</p>
<p>If <i>text</i> or <i>html</i> is set, but not both, then that will become the plain
content of the email. If both are set then a multipart/alternate entity will be created
with <i>html</i> as the preferred alternative. This is consistant with convention. If <i>html</i>
alone is set, the structure will <b>not</b> create a non-HTML version of the content.</p>

<p><b>Example:</b></p>
<p>
<pre>
  Email email;

  email.text = "Main body part";
  email.html = "&lt;p>Main body part&lt;/p>";

  email.subject = "Subject";
  email.from = Mailbox("jason@jaypha.com.au", "Jason den Dulk");
  email.to = "anyone@anything.net";

  email.attachments ~= Email.Attachment(
    "Clown",
    "image/jpeg",
    getImageContentsFromSomewhere(),
    "clown.jpg"
  );

  email.send();
</pre></p>
<p><b>Properties:</b></p>
<table class='parms'>
<tr><td class='code'>string <i>subject</i></td><td>Email subject</td></tr>
<tr><td class='code'>Mailbox <i>from</i><br/>&nbsp;&nbsp;&nbsp;from(Mailbox v)<br/>&nbsp;&nbsp;&nbsp;from(string v)</td><td>Sender email address</td></tr>
<tr><td class='code'>Mailbox[] <i>to</i><br/>&nbsp;&nbsp;&nbsp;to(Mailbox v)
                        <br/>&nbsp;&nbsp;&nbsp;to(Mailbox[] v)
                        <br/>&nbsp;&nbsp;&nbsp;to(string v)
                        <br/>&nbsp;&nbsp;&nbsp;to(string[] v)
                        </td><td>Standard recipients</td></tr>
<tr><td class='code'>Mailbox[] <i>cc</i><br/>&nbsp;&nbsp;&nbsp;cc(Mailbox v)
                        <br/>&nbsp;&nbsp;&nbsp;cc(Mailbox[] v)
                        <br/>&nbsp;&nbsp;&nbsp;cc(string v)
                        <br/>&nbsp;&nbsp;&nbsp;cc(string[] v)</td><td>Carbon copy (cc) recipients</td></tr>
<tr><td class='code'>Mailbox[] <i>bcc</i><br/>&nbsp;&nbsp;&nbsp;bcc(Mailbox v)
                        <br/>&nbsp;&nbsp;&nbsp;bcc(Mailbox[] v)
                        <br/>&nbsp;&nbsp;&nbsp;bcc(string v)
                        <br/>&nbsp;&nbsp;&nbsp;bcc(string[] v)</td><td>Blind carbon copy (bcc) recipients</td></tr>
<tr><td class='code'>string <i>text</i></td><td>Unformatted text contents</td></tr>
<tr><td class='code'>string <i>html</i></td><td>HTML formatted contents</td></tr>
<tr><td class='code'>Email.Attachment[] <i>attachments</i></td><td>Attachments</td></tr>
</table>
<b>Mehtods:</b>
<table class='parms'>
<tr><td class='code'>addHeader</td><td>Adds a generic header.</td></tr>
<tr><td class='code'>copy</td><td>Send a formatted copy to an output range.</td></tr>
<tr><td class='code'>sendmail</td><td>Send via sendmail program (Linux only).</td></tr>
<tr><td class='code'>send</td><td>Send via Curl (requires curl library).</td></tr>
</table>

</dd>

<dt class="d_decl">struct <a name="Email-Attachment"></a><span class="funcName">Email.Attachment</span></dt>
<dd><p> A structure for email attachments.</p>
<p><b>Properties:</b></p>
<table class='parms'>
<tr><td class='code'>string <i>name</i></td><td>Title</td></tr>
<tr><td class='code'>string <i>mimeType</i></td><td>MIME type</td></tr>
<tr><td class='code'>immutable(ubyte)[] <i>content</i></td><td>Attachment contents</td></tr>
<tr><td class='code'>string <i>fileName</i></td><td>File name</td></tr>
</table>

<h3>jaypha.inet.imf.writing</h3>

<dt class="d_decl">struct <a name="Mailbox"></a><span class="funcName">Mailbox</span></dt>
<dd><p> A container for email addresses.</p><p>Mailbox is used to format email addresses
for IMF headers.</p>

<p><b>Properties:</b></p>
<table class='parms'>
<tr><td class='code'>string <i>address</i></td><td>Email address</td></tr>
<tr><td class='code'>string <i>name</i></td><td>Optional name for the person</td></tr>
</table>
<p><b>Example:</b></p>
<pre>
  auto mb = Mailbox("abc@abc.net", "John Abc");
  assert(mb.asString == "John Abc &lt;abc@abc.net>");

  mb = Mailbox("abc@abc.net");
  assert(mb.asString == "abc@abc.net");
</pre>
</dl>

<h2>Appendix: Relevant RFCs</h2>
<p><b>IMF is covered by</b></p>

<table>
 <tr><td>RFC5322</td><td>IMF specification (defines header syntax)</td></tr>
 <tr><td>RFC6854</td><td>Update to allow multiple senders.</td></tr>
 <tr><td>RFC6152</td><td>8-bit extension.</td></tr>
 <tr><td>RFC2387</td><td>multipart/related</td></tr>
</table>

<p><b>MIME is covered by</b></p>

<table>
 <tr><td>RFC2045</td><td>Original MIME Specs</td></tr>
 <tr><td>RFC2046</td><td>MIME Types</td></tr>
 <tr><td>RFC2047</td><td>Non ASCII in IMF headers.</td></tr>
 <tr><td>RFC2049</td><td>MIME Conformance</td></tr>
 <tr><td>RFC2183, 2184, 2231</td><td>Content Disposition Header</td></tr>
</table>

<p><b>Other related RFCs</b></p>

<table>
 <tr><td>RFC4289</td><td>Registration Procedures for MIME</td></tr>
 <tr><td>RFC4855</td><td>Media Type Registration of RTP Payload Formats</td></tr>
 <tr><td>RFC6838</td><td>Media Type Specifications and Registration Procedures</td></tr>
 <tr><td>RFC4021</td><td>Registration of Mail and MIME Header Fields</td></tr>
 <tr><td>RFC5321</td><td>Simple Mail Transfer Protocol</td></tr>
</table>

<p><b>Other Refernces</b></p>
<p>
<a href='http://www.iana.org/assignments/media-types/media-types.xhtml'>Registered MIME Types</a></br>
<a href='http://www.stdicon.com/mimetypes'>Mime Type file Extensions (JSON)</a><br/>
</p>